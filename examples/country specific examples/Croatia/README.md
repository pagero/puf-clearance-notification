# Croatia Clearance Notification Examples

This directory contains example PUF clearance notification files demonstrating Croatian eRačun (e-invoicing) system responses for fiscalization and clearance processes.

## Overview

The Croatian Tax Administration operates the eRačun system for electronic invoice clearance and fiscalization. After submitting an invoice to the Croatian clearance authority, businesses receive clearance notification messages indicating whether the invoice was approved, approved with warnings, or rejected.

These examples demonstrate the three main clearance response scenarios and tax report notifications that implementers will encounter when integrating with the Croatian eRačun system.

## Example Files

### 1. PUF_clearance_notification_Croatia_APPROVED.xml

**Invoice Approved - Full Success**

Demonstrates a clearance notification where the Croatian eRačun system has successfully validated and approved the invoice without any issues and invoice has been delivered.

**Key Features:**

- Response code: `APPROVED`
- Status: `VALID_APPROVED`
- Includes `ClearanceReferenceID` (generated by clearance authority)
- Contains third-party `documentId` for payment reporting

**Use Case:** Standard successful invoice submission to Croatian fiscalization system.

---

### 2. PUF_clearance_notification_Croatia_APPROVED_WITH_WARNINGS.xml

**Invoice Approved with Warnings - Distribution Limited**

Demonstrates a clearance notification where the invoice is technically valid and approved by the Croatian Tax Administration, but electronic delivery to the recipient is not possible.

**Key Features:**

- Response code: `APPROVED_WITH_WARNINGS`
- Primary status: `VALID_APPROVED` - Invoice is fiscally valid
- Warning status: `RECIPIENT_NOT_IN_AMS` - Recipient not registered in Addressing Management System
- Includes `ClearanceReferenceID` from clearance authority
- Invoice is fiscally compliant but requires alternative delivery method

**Multiple Status Elements:**

```xml
<cac:Status>
    <cbc:StatusReasonCode>VALID_APPROVED</cbc:StatusReasonCode>
    <cbc:StatusReason>Invoice is valid and approved by Croatian eRačun system</cbc:StatusReason>
</cac:Status>
<cac:Status>
    <cbc:StatusReasonCode>RECIPIENT_NOT_IN_AMS</cbc:StatusReasonCode>
    <cbc:StatusReason>Recipient is not registered in AMS...</cbc:StatusReason>
</cac:Status>
```

**Use Case:** Invoice approved for fiscal purposes but must be delivered through alternative channels (email, paper) as recipient is not registered in the AMS system for electronic delivery.

---

### 3. PUF_clearance_notification_Croatia_REJECTED.xml

**Invoice Rejected - Validation Failed**

Demonstrates a clearance notification where the Croatian eRačun system has rejected the invoice due to a validation error.

**Key Features:**

- Response code: `REJECTED`
- Error code: `S_008` (Duplicate invoice identifier)
- No `ClearanceReferenceID` (invoice not cleared)
- Original invoice reference included

**Error Information:**

```xml
<cac:Status>
    <cbc:StatusReasonCode>S_008</cbc:StatusReasonCode>
    <cbc:StatusReason>Već postoji zabilježen eRačun s istim identifikatorom.</cbc:StatusReason>
</cac:Status>
```

**Use Case:** Invoice submission failed validation - requires correction and resubmission with unique identifier.

---

### 4. PUF_taxreport_notification_Croatia_APPROVED.xml

**Tax Report Approved**

Demonstrates a notification for a tax data report that has been successfully validated and approved by the Croatian Tax Administration.

**Key Features:**

- Response code: `APPROVED`
- Includes `ClearanceReferenceID`
- References tax report submission

**Use Case:** Tax reporting data successfully submitted and accepted by Croatian authorities.

---

### 5. PUF_taxreport_notification_Croatia_REJECTED.xml

**Tax Report Rejected**

Demonstrates a clearance notification for a tax data report that has been rejected due to no valid original invoice.

**Key Features:**

- Response code: `REJECTED`
- Error code: `S_009` (Invoice does not exist)
- Detailed error message with affected elements

**Use Case:** Tax report failed - please check original invoice number.

---

## Clearance Response Codes

The Croatian eRačun system returns three possible clearance outcomes:

| Response Code | Meaning | Fiscally Valid | Electronic Delivery | Action Required |
|--------------|---------|----------------|-------------------|-----------------|
| `APPROVED` | Fully approved | ✅ Yes | ✅ Yes | None - Success |
| `APPROVED_WITH_WARNINGS` | Approved with limitations | ✅ Yes | ❌ No | Use alternative delivery |
| `REJECTED` | Validation failed | ❌ No | ❌ No | Fix errors and resubmit |

## Croatian Fiscalization Error Codes

When implementing Croatian e-invoicing clearance, you may encounter the following error codes from the eRačun fiscalization system:

### Error Code Reference

| Code | Croatian Description | English Description |
|------|---------------------|---------------------|
| None | Nema greške | No error |
| S_001 | Sistemska greška prilikom obrade zahtjeva | System error during request processing |
| S_002 | Lokacija potpisa nije ispravna | Signature location is not valid |
| S_003 | Certifikat nije izdan od davatelja usluga s Pouzdanog potpisa, ili je istekao ili je ukinut | Certificate is not issued by a trusted signature service provider, or has expired or been revoked |
| S_004 | Neispravan potpis zahtjeva | Invalid request signature |
| S_005 | Poruka nije u skladu s XML shemom : #element ili lista elemenata koji nisu ispravni po shemi | Message is not compliant with XML schema: #element or list of elements that are not valid according to the schema |
| S_006 | Pristupna točka nije ovlaštena za dostavu podataka | Access point is not authorized to submit data |
| S_007 | OIB iz zahtjeva nije formalno ispravan: #vrijednost OIB-a iz upita | OIB from request is not formally valid: #OIB value from query |
| S_008 | Već postoji zabilježen eRačun s istim identifikatorom | An eInvoice with the same identifier already exists |
| S_009 | Ne postoji zabilježen eRačun | The eInvoice does not exist |
| S_010 | Već postoji zabilježen status odbijanja eRačuna s istim identifikatorom | An eInvoice rejection status with the same identifier already exists |
| S_011 | Nepoznata greška | Unknown error |
| S_012 | Ne postoji evidentiran originalni eRačun za koji je dostavljen ispravljeni eRačun | There is no recorded original eInvoice for which the corrected eInvoice was submitted |

## Message Structure

### Key Elements in Clearance Notifications

#### Response Information

```xml
<cac:Response>
    <cbc:ResponseCode>APPROVED|APPROVED_WITH_WARNINGS|REJECTED</cbc:ResponseCode>
    <cac:Status>
        <cbc:StatusReasonCode>S_001-S_012 or VALID_APPROVED</cbc:StatusReasonCode>
        <cbc:StatusReason>Detailed message in Croatian</cbc:StatusReason>
    </cac:Status>
</cac:Response>
```

#### Clearance Reference (Approved invoices only)

```xml
<puf:ClearanceReferenceID>
    <cbc:ID>8de0ff99-6513-50d6-b2d3-f5f5141c4920</cbc:ID>
</puf:ClearanceReferenceID>
```

#### Document Reference

```xml
<cac:DocumentReference>
    <cbc:ID>HR-2025-00144</cbc:ID>
    <cbc:IssueDate>2025-10-20</cbc:IssueDate>
    <cbc:DocumentTypeCode>380</cbc:DocumentTypeCode>
</cac:DocumentReference>
```

## Croatian-Specific Elements

### Sender Party

The clearance authority is always identified as:

```xml
<cac:SenderParty>
    <cac:PartyName>
        <cbc:Name>Croatia eRačun</cbc:Name>
    </cac:PartyName>
</cac:SenderParty>
```

### Receiver Party

The original invoice submitter identified by OIB:

```xml
<cac:ReceiverParty>
    <cbc:EndpointID>82430769254</cbc:EndpointID>
    <cac:PartyLegalEntity>
        <cbc:RegistrationName>Pagero AB</cbc:RegistrationName>
    </cac:PartyLegalEntity>
</cac:ReceiverParty>
```

## References

- [PUF Clearance Notification Specification](https://pagero.github.io/puf-clearance-notification/)
- [PUF Code Lists](https://pagero.github.io/puf-code-lists/)
- Croatian Tax Administration - eRačun System Documentation
- [PUF Billing Specification - Croatia Section](https://pagero.github.io/puf-billing/#_croatia)

---

**Note:** These examples use realistic but anonymized data. Always use Croatian Tax Administration test environment for development and testing before production deployment.
